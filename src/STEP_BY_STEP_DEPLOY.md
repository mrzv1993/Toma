# üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é Edge Function

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

‚ùå **Edge Function –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞**
```
{"code":"NOT_FOUND","message":"Requested function was not found"}
```

‚úÖ **–ö–æ–¥ –≥–æ—Ç–æ–≤** –≤ `/supabase/functions/server/index.tsx`

‚è±Ô∏è **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2-3 –º–∏–Ω—É—Ç—ã (–ø–µ—Ä–≤—ã–π —Ä–∞–∑), 30 —Å–µ–∫—É–Ω–¥ (–ø–æ—Å–ª–µ–¥—É—é—â–∏–µ)

---

## –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Supabase CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–∏ CLI:
```bash
supabase --version
```

–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –≤–µ—Ä—Å–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `1.123.4`) - **–ø–µ—Ä–µ—Ö–æ–¥–∏—Ç–µ –∫ –®–∞–≥—É 2**.

### –ï—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:

**macOS (Homebrew):**
```bash
brew install supabase/tap/supabase
```

**Windows/Linux/macOS (npm):**
```bash
npm install -g supabase
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:**
```bash
supabase --version
```

---

## –®–∞–≥ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Supabase

```bash
supabase login
```

–≠—Ç–æ –æ—Ç–∫—Ä–æ–µ—Ç –±—Ä–∞—É–∑–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
1. –ù–∞–∂–º–∏—Ç–µ "Authorize"
2. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å: `‚úì Logged in`

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç—É:**
```bash
supabase projects list
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ–µ–∫—Ç `gyeavjcumghuiblzjwnx` –≤ —Å–ø–∏—Å–∫–µ.

---

## –®–∞–≥ 3: –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–∞–ø–∫–∞ supabase/)
cd /path/to/your/toma/project

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
ls -la supabase/functions/server/
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å —Ñ–∞–π–ª `index.tsx`.

---

## –®–∞–≥ 4: –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

### –°–ø–æ—Å–æ–± A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑)
chmod +x deploy-edge-function.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π
./deploy-edge-function.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É CLI
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- ‚úÖ –ó–∞–¥–µ–ø–ª–æ–∏—Ç —Ñ—É–Ω–∫—Ü–∏—é
- ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–µ—Ç endpoints
- ‚úÖ –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°–ø–æ—Å–æ–± B: –í—Ä—É—á–Ω—É—é

```bash
supabase functions deploy server --project-ref gyeavjcumghuiblzjwnx --no-verify-jwt
```

**–ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ:**
```
Deploying server (project ref: gyeavjcumghuiblzjwnx)
Bundling server
Deploying server (version xxxxxxxx)
‚úÖ Deployed Function server
URL: https://gyeavjcumghuiblzjwnx.supabase.co/functions/v1/server
```

---

## –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è

### A. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ curl (–≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

```bash
curl https://gyeavjcumghuiblzjwnx.supabase.co/functions/v1/server/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{"status":"ok","timestamp":"2025-12-06T12:34:56.789Z","version":"1.0.0"}
```

### B. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –±—Ä–∞—É–∑–µ—Ä

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://gyeavjcumghuiblzjwnx.supabase.co/functions/v1/server/health
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å JSON —Å `"status":"ok"`.

### C. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

1. **–û—Ç–∫—Ä–æ–π—Ç–µ:** https://tommma.ru
2. **–ñ–µ—Å—Ç–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞:** `Ctrl+F5` (Win) –∏–ª–∏ `Cmd+Shift+R` (Mac)
3. **–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å (F12)** –∏ –Ω–∞–π–¥–∏—Ç–µ:
   ```
   ‚úÖ Server health check passed: {status: "ok", ...}
   ```
4. **–ö—Ä–∞—Å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –¥–æ–ª–∂–µ–Ω –∏—Å—á–µ–∑–Ω—É—Ç—å**
5. **–î–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –Ω–∞—á–∞—Ç—å –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è**

---

## –®–∞–≥ 6: –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```bash
supabase functions logs server --project-ref gyeavjcumghuiblzjwnx --follow
```

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` —á—Ç–æ–±—ã –≤—ã–π—Ç–∏.

---

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "supabase: command not found"

**–†–µ—à–µ–Ω–∏–µ:** CLI –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ –®–∞–≥—É 1.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "Error: Not logged in"

**–†–µ—à–µ–Ω–∏–µ:** 
```bash
supabase login
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Error: Project not found"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç—É:
```bash
supabase projects list
```

–ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "Syntax error in function"

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å TypeScript –≤ —Ñ–∞–π–ª–µ:
```bash
cat supabase/functions/server/index.tsx | head -30
```

–§–∞–π–ª –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å:
```typescript
import { Hono } from 'npm:hono@4';
import { cors } from 'npm:hono/cors';
```

### –ü—Ä–æ–±–ª–µ–º–∞ 5: Health check –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 404 –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥–æ–∂–¥–∏—Ç–µ 10-15 —Å–µ–∫—É–Ω–¥ - —Ñ—É–Ω–∫—Ü–∏—è –º–æ–∂–µ—Ç –ø—Ä–æ–≥—Ä–µ–≤–∞—Ç—å—Å—è (cold start).

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞:
```bash
curl https://gyeavjcumghuiblzjwnx.supabase.co/functions/v1/server/health
```

### –ü—Ä–æ–±–ª–µ–º–∞ 6: "Missing secrets"

**–†–µ—à–µ–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```bash
supabase secrets list --project-ref gyeavjcumghuiblzjwnx
```

–î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY`
- `SUPABASE_ANON_KEY`

–ï—Å–ª–∏ —á–µ–≥–æ-—Ç–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, –æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è Supabase, –Ω–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Dashboard ‚Üí Settings ‚Üí API.

---

## –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥

```bash
# –î–µ–ø–ª–æ–π
supabase functions deploy server --project-ref gyeavjcumghuiblzjwnx

# –õ–æ–≥–∏
supabase functions logs server --project-ref gyeavjcumghuiblzjwnx --follow

# –¢–µ—Å—Ç health check
curl https://gyeavjcumghuiblzjwnx.supabase.co/functions/v1/server/health

# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤
supabase projects list

# –°–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π
supabase functions list --project-ref gyeavjcumghuiblzjwnx

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
supabase secrets list --project-ref gyeavjcumghuiblzjwnx
```

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ https://tommma.ru
2. ‚úÖ –í—Å–µ API endpoints –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã
3. ‚úÖ –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è
4. ‚úÖ –ö—Ä–∞—Å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –∏—Å—á–µ–∑–Ω–µ—Ç
5. ‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –±—É–¥—É—Ç –∑–µ–ª–µ–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏ –≤–º–µ—Å—Ç–æ –æ—à–∏–±–æ–∫

---

## –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

- üìñ **–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:** `/README_QUICK_FIX.md`
- üìã **–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:** `/DEPLOY_NOW.md`
- üîß **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:** `/EDGE_FUNCTION_SETUP.md`
- üíª **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç:** `./deploy-edge-function.sh`

---

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö —à–∞–≥–æ–≤: 2-3 –º–∏–Ω—É—Ç—ã**

–£–¥–∞—á–∏! üöÄ
